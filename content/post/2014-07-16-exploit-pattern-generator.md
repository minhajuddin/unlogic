---
comments: true
date: 2014-07-16T00:00:00Z
image:
  credit: null
  creditlink: null
  feature: http://i.imgur.com/9tWsWOu.png
modified: 2014-07-16 13:57:12 +0100
share: null
tags:
- exploit
- pattern generator
title: Exploit pattern generator
url: /2014/07/16/exploit-pattern-generator/
---

I've been playing around with various stack exploits and have made a fair bit
of use of metasploit's pattern generation and search tools in order to find
EIP overwrite locations in an overflow string. This works very well indeed, 
but I had a couple of issues: Firstly I had to have my Kali (or whatever
pentest distro) VM running. Secondly running the scripts was very slow. Go on
give them a go.

I was told about [peda](https://github.com/longld/peda) which is a 
Python Exploit Development Assistance for GDB. This is great, but I am playing
some war games on either virtual machines or remote boxes where I can't install
things like this. And I didn't want to have to copy binaries around all the time
either. So I looked for some alternatives. There were (unsurprisingly) quite
a few, but they were in Perl or Ruby. I was seeking a Python implementation.

[So I rolled my own](https://github.com/Svenito/exploit-pattern)

It will generate a pattern exactly like the Metasploit one up to a maximum of 
20280 characters in length. Usage is dead simple. To generate a pattern just
supply the desired length:

{{< highlight console >}}
$> pattern.py 100
Aa0Aa0Aa1Aa1Aa2Aa2Aa3Aa3Aa4Aa4Aa5Aa5Aa6Aa6Aa7Aa7Aa8Aa8Aa9Aa9Ab0Ab0Ab1Ab1Ab2Ab
2Ab3Ab3Ab4Ab4Ab5Ab5Ab6A
{{< / highlight >}}

And to search for a pattern:

{{< highlight console >}}
$> pattern.py Bf4
Pattern Bf4 first occurrence at position 942 in pattern.
$> pattern.py Bf4B
Pattern Bf4B first occurrence at position 942 in pattern.
$> pattern.py 0x42346642
Pattern 0x42346642 first occurrence at position 942 in pattern.
{{< / highlight >}}

As you can see it converts the hex representation to the correct pattern. The
position is **0**(zero) indexed. I'll have to double check how Metasploit's version
returns the offset to match that.

Not sure how often you need a pattern above 20k characters, but if you do,
let me know and I'll work on it.


