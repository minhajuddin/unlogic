<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Hacky Easter 2015 - Unlogic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <meta name="keywords" content="">
  <link rel="canonical" href="http://unlogic.co.uk/2015/06/01/hacky-easter-2015/">

  
  

  
  

  
  

  <link rel="stylesheet" type="text/css" href="http://unlogic.co.uk//css/combined-min.css">

</head>
<body class="">

<div class="site-wrap">
  <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://unlogic.co.uk/" class="site-title">Unlogic</a>
      <nav class="site-nav right">
      <a href="http://unlogic.co.uk/about/">About</a>
<a href="http://unlogic.co.uk/tags">Tags</a>
<a href="http://unlogic.co.uk/contact/">Contact</a>

</form>

      </nav>
      <div class="clearfix"></div>
    </div>
  </div>
</header>

  <div class="post p2 p-responsive wrap" role="main">
    <div class="measure">
      <div class="post-header mb2">
        <h1 class="py2">Hacky Easter 2015</h1>
        <span class="post-meta">Jun 1, 2015 by </span><br>
        
      </div>

      <article class="post-content">
      

<p>Another year, another Hacky Easter and a month, of fun, learning, and
frustrations. All in all this was another great year and I&rsquo;m already looking
forward to 2016&rsquo;s edition. I found this year&rsquo;s challenges were a bit harder than
last year, but I did my best.</p>

<h1 id="challenge-01:00aa8d5840836b6803fb0a2203b66750">Challenge 01</h1>

<p>I&rsquo;m told to search out the password in the following image</p>


<figure >
    
        <img src="http://i.imgur.com/mIXj50g.jpg" />
    
    
</figure>


<p>Taking note of the missing letters and rearranging them to spell <code>HACKERZ</code> I&rsquo;ll enter
that into the egg-o-matic and see what happens. Oh, hello there&rsquo;e the egg.</p>

<h1 id="challenge-02:00aa8d5840836b6803fb0a2203b66750">Challenge 02</h1>

<p>The eggs is already there:</p>


<figure >
    
        <img src="http://i.imgur.com/98japcd.png" />
    
    
</figure>


<p>But it won&rsquo;t scan in its current state, not with <em>NO</em> written in the QR code.
First things first I looked at the page and image source. Turns out that this is
not an image, but a table instead. I examined the table with Firebug and noticed
that the elements of the <em>NO</em> have different CSS tags. Looking up at the header I
saw that those tags were defined twice, causing the values to be overriden.</p>

<p>I created a local copy, set the values to the initial values (so delete the second
definition) and then we get a valid QR code that will scan.</p>

<h1 id="challenge-03:00aa8d5840836b6803fb0a2203b66750">Challenge 03</h1>

<p>Lego. I love Lego, and therefore already knew what an <code>ldx</code> file is. So I opened
it in Lego Digital Designer and took a look at the bricks. Looks like quite a hard
code to crack. Although it seems a little odd that the bottom layer is 3 bricks deep.
I started picking away some of the first layer and there were white and black bricks
underneath. Potentially a QR code? Even using the &ldquo;Select colour and shape&rdquo; tool, removing
all the top layer bricks will take a little while, but we are then rewarded with a valid QR code.</p>

<h1 id="challenge-04:00aa8d5840836b6803fb0a2203b66750">Challenge 04</h1>

<p>Mobile challenge. I get a list of numbers, or definitions of numbers,
and I have to arrange them in order. The easiest way to do this was to write them in a
file and then use the linux <code>sort</code> command to order them accordingly. Once I had the
list it was just a matter of ordering them in the right order on the phone, and submitting them
to get the egg.</p>

<h1 id="challenge-05:00aa8d5840836b6803fb0a2203b66750">Challenge 05</h1>

<p>Another mobile challange. I get shown four bars, each one of which is controlled
by some phone sensor. The middle two were easy to discover. Just by moving the phone I could
see that the orientation and tilt controlled those. The top bar increased every 5 seconds. The
bottom bar however was a bit trickier. It took a day to discover this, because it actually
represents the time the phone has been charging since the app was run for the first time.</p>

<p>I left it plugged in and waited until the bar was green, aligned the phone correctly and then
waited for the 5 second bar to fill up to collect my egg.</p>

<h1 id="challenge-06:00aa8d5840836b6803fb0a2203b66750">Challenge 06</h1>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="go">dah-dah-dit dit dah-dah-dah di-dah-dit dah-dah-dit dit dah-dah dah-di-dah-dit di-di-dah-dit di-dah-di-dit dah-di-dah-dah</span>
</code></pre></div>


<p>This is clearly morse code. <code>dit</code> and <code>di</code> are dots and the <code>dah</code> is dash. Decoded this to get
<code>georgemcfly</code>. I entered this and was told I was 3 months too early! Only one thing for it:
change the system date to 3 months in the future. Resubmitted the password and was granted the egg.</p>

<h1 id="challenge-07:00aa8d5840836b6803fb0a2203b66750">Challenge 07</h1>

<p>Mobile challange. I need to navigate a Google street view style app to search for the
egg. I was actually surprised how easy it was to find. On the second screen
I looked up and there it was, in the sky. Easy right? Well, once I capped the image, I brought
it into Gimp and manipulated it. Took quite a bit of cleanup and contrast tweaking to get it to scan,
but I got there in the end.</p>

<h1 id="challenge-08:00aa8d5840836b6803fb0a2203b66750">Challenge 08</h1>

<p>So from a spreadsheet ID I have to find this particular spreadsheet? Like any sensible person
I avoid working with spreadsheets as much as I can, so I had to investigate how Google
docs uses these IDs. Luckily once you create a new sheet, you can already identify the ID in the URL.
Replace your ID with the Hacky Easter one and you are given the sheet.</p>

<p>The problem is that the sheet is jumbled up. You need to order the colums and rows in numerical order.
I could have done this in Python, but at the time I got <em>1</em> back for the black boxes. Being
a spreadsheet n00b I didn&rsquo;t know about conditional formating, but you can specify cell formatting based
on content. So that would have been the easy way.</p>

<p>Instead I did it manually. Ordering the rows can be done automatically. Then I just copy
pasted the colums in order and snapped the code. Tedious, but produces results.</p>

<h1 id="challenge-09:00aa8d5840836b6803fb0a2203b66750">Challenge 09</h1>

<p>Mobile challenge. The app&rsquo;s splash screen is egg #9, but distorted. With some
skilled timing I screen capped it and imported it into Pixelmator, where I
used the bulge tool to undistort it enough to be able to scan it.</p>

<p>Alternatively I could have grabbed the image out of the APK I reckon, but
this was simpler at the time.</p>

<h1 id="challenge-10:00aa8d5840836b6803fb0a2203b66750">Challenge 10</h1>

<p>Thumper&rsquo;s got egg 10? Where could he have taken it? Initially I decided
to look in the other challenges and there is one challenge that has a banner
at the bottom. It is an advert for Thumper&rsquo;s info sec training course. Clicking
the banner merely told me that &lsquo;the egg is not in any challenge&rsquo;. They knew we&rsquo;d
come looking.</p>

<p>So where else would people keep eggs? Of course, on the pages where you can see
the eggs each user has. The url for which is <code>http://hackyeaster.hacking-lab.com/hackyeaster/eggs.html?name=hops</code>
so all we do it replace the user <code>hops</code> with <code>Thumper</code> and sure enough, that&rsquo;s
where he&rsquo;s hidden the egg.</p>

<h1 id="challenge-11:00aa8d5840836b6803fb0a2203b66750">Challenge 11</h1>

<p>I was expecting this to be a bit harder, but I just downloaded the files,
opened them up in Thunderbird and found a message with attachments. Downloading
the attachment gives you the egg.</p>

<h1 id="challenge-12:00aa8d5840836b6803fb0a2203b66750">Challenge 12</h1>

<p>A quiz! Simple of course. Well, this is Hacky Easter, so no. The fields are all
incorrectly configured. Look at the source and you can see:</p>

<ul>
<li>Field 1 will change it contents when it loses focus.</li>
<li>Field 2 is a number field but should be a string</li>
<li>Field 3 is a text field but should be a number</li>
<li>Field 4 is a radio button set, but should be checkboxes</li>
<li>Field 5 is a dropdown that is missing the right answer</li>
</ul>

<p>So I worked out the answers, as I still need to get them right, and then I used
Firebug to edit the HTML in place. Once ready I hit <em>Submit</em> only to find I was
wrong. I am sure everything was correct though. I double checked the fields, and
then I noticed that the submit button had <code>value=&quot;false&quot;</code> on it.</p>

<p>Once I edited them all again and set the submit button to <code>true</code> I was granted access
to the egg.</p>

<h1 id="challenge-13:00aa8d5840836b6803fb0a2203b66750">Challenge 13</h1>

<p>This challenge had me going for quite a while. A great example of how you learn
to observe information. Downloading the video I see a 15 minute video that has a
different QR code every second (approx). Each QR code resolves to a egg style
string, so there&rsquo;s no automated way to filter out the right code.</p>

<p>I can&rsquo;t watch it and scan each egg, that would take forever. So I thought about
what I know. Eventually it dawned on me that it&rsquo;s called <em>LEET TV</em>. Leet = 7337.
I wonder if&hellip; scrub the video to 7337 and scan the code. Error message.</p>

<p>But careful, this isn&rsquo;t the same message as you would get if you scan an invalid
egg. I used a different barcode scanner to scan this code and was given a URL. Result!</p>

<p>Visiting the URL I download a wav file, which is clearly a reversed audio recording.</p>

<p>Importing into Audacity, reversing it, and playing it back tells us the timestamp
in the video where the correct QR is shown.</p>

<h1 id="challenge-14:00aa8d5840836b6803fb0a2203b66750">Challenge 14</h1>

<p>On a hunch I just decided to use a 2d barcode scanner to scan the code and see
what happens. Oh, it gives us an egg string. But the app&rsquo;s scanner will only accept
2d codes. Not to worry. Using duckduckgo&rsquo;s qr code creator we can just enter the string
we get from the 1d code, and in return we get a 2d code which we can scan with the
Hacky Easter app.</p>

<h1 id="challenge-15:00aa8d5840836b6803fb0a2203b66750">Challenge 15</h1>

<p>This one was fiendish for me. In the end I actually took apart the APK and
disassembled the code to try and see what this does. From this I could see
that it stores the pics on your SD card. It also runs some analysis on the images,
based on the pixel values. I assumed that it was in fact looking for a picture
of a tomato and a grassy field.</p>

<p>I took a picture of a green screen and managed to get it to return one half of the
code. The tomato was a bit trickier, as a simply red image was not enough. It actually
needed <em>some</em> green in it. Google image search for <em>tomato</em> and took a reasonalbe pic,
which gave me the other half of the code.</p>

<p>After downloading the pics to my desktop, it was just a matter of joining them together
to give me the complete egg.</p>

<p>Was a little bit hit and miss with the pic taking, but nice idea for a challenge.</p>

<h1 id="challenge-16:00aa8d5840836b6803fb0a2203b66750">Challenge 16</h1>

<p><em>Ghosts only come out when it&rsquo;s dark&hellip;</em></p>

<p>This required a few things: a keen eye, and knowledge of crypto.</p>

<p>So firstly we know that we need to make it dark or something. After a while
I finally noticed the light bulb at the bottom right of the main
challenges page. Clicking that makes the page dark and changes the thumbnail for
challenge 16. Now when we click on it we get a set of 4 strings and picture of
a &ldquo;The Ring&rdquo; girl with the word <em>spooky</em> written across it. We are also told:</p>

<p><em>Dark is beautiful. A GOST with chaining appears and has a message for you</em></p>

<p>Nothing is a coincidence, so that&rsquo;s no typo. Searching for <em>GOST</em> I discovered that
it was an encryption method. After quite a bit more searching I discovered that
PHP&rsquo;s mcrypt library supports decrypting this cipher. The cipher requires a
key. On a hunch I decided to use the only other clue available: <em>spooky</em></p>

<p>Now this is where I almost failed. I could decrypt the first code without any
problem. It resulted in the string <code>http://hackyeas</code>. But the second string&rsquo;s
first 8 characters were corrupt. I was so stuck until I discovered that
you had to append all the ciphers together in order to get the plaintext. I guess
that&rsquo;s the <code>chaining</code> part, as well as indicating we should used <code>MCRYPT_MODE_CBC</code>.</p>

<p>This PHP script ended up doing the work for me</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="nv">$hash1</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s1">&#39;d5++xytj6RiGwmqEecm63Kow7RZGAAHh&#39;</span><span class="p">);</span>
<span class="nv">$hash2</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s1">&#39;VFsksHFuj/Anap7pWHDZ1XQw8DAApUEN&#39;</span><span class="p">);</span>
<span class="nv">$hash3</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s1">&#39;R5ExOGUKTzGOtvSAlCHkHq6NneL6ZUTX&#39;</span><span class="p">);</span>
<span class="nv">$hash4</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="s1">&#39;ej8Taxz+kHK9w9U8dxTOSksZ4HKS2YYD&#39;</span><span class="p">);</span>

<span class="nv">$res</span> <span class="o">=</span> <span class="nb">mcrypt_decrypt</span><span class="p">(</span><span class="nx">MCRYPT_GOST</span><span class="p">,</span> <span class="s1">&#39;spooky&#39;</span><span class="p">,</span> <span class="nv">$hash1</span><span class="o">.</span><span class="nv">$hash2</span><span class="o">.</span><span class="nv">$hash3</span><span class="o">.</span><span class="nv">$hash4</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$res</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
</code></pre></div>


<p>Running it:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">$</span>&gt; php ./gost.php <span class="p">|</span> base64 -d
<span class="go">http://hackyeaster.hacking-lab.com/hackyeaster/images/egg_16_a3eIIACKSy02sJ6LxXeh.png</span>
</code></pre></div>


<p>No initialisation vector was required, so you can ignore the warning.</p>

<h1 id="challenge-17:00aa8d5840836b6803fb0a2203b66750">Challenge 17</h1>

<p>There&rsquo;s no real way to spot the difference in the images with your eyes. So the
easiest way is to bring them into Gimp on separate layers. Then I adjusted the top
layer&rsquo;s blend mode to &ldquo;difference&rdquo; so that I could see which pixels differ. The image
goes black indicating that there&rsquo;s no differences. Impossible!</p>

<p>Now thinking that there must be differences I figured that they might be so small
that they appear black. I maxed the contrast and brightness to get:</p>


<figure >
    
        <img src="http://i.imgur.com/0iAoovp.jpg" />
    
    
</figure>


<p>Now the QR code is in the left eye, and a target shape in the right. The target
needs to be used to invert the pixels in the QR code. Once done, snap the code
and move on.</p>

<h1 id="challenge-18:00aa8d5840836b6803fb0a2203b66750">Challenge 18</h1>

<p>Once we visit the site we get asked to authenticate. No doubt the details will be in
the pcap file, so let&rsquo;s open that. We can see a failed auth followed by a successful
one. Inspect the relevant packet and we get the login:</p>


<figure >
    
        <img src="http://i.imgur.com/dhLNYS9.png" />
    
    
</figure>


<p>Using this to login we are presented with another login form. Trying the same
credentials gives a &ldquo;Payment required&rdquo; page. Heading back to the pcap file let&rsquo;s
see if we can&rsquo;t find some details for this part too. Ah, right there at the bottom.</p>


<figure >
    
        <img src="http://i.imgur.com/Gp45s1R.png" />
    
    
</figure>


<p>This time however we need to pass the hash and login details via POST. Either
edit the form, or use a tool like Zap or Burp proxy, to add this data to the POST
and we have our egg.</p>

<h1 id="challenge-19:00aa8d5840836b6803fb0a2203b66750">Challenge 19</h1>

<p>Not found.</p>

<p>I will add a solution here later.</p>

<h1 id="challenge-20:00aa8d5840836b6803fb0a2203b66750">Challenge 20</h1>

<p>The big clue here is robots. Why do we love robots? <code>robots.txt</code> is why. Taking a
look at it I can see</p>

<div class="highlight"><pre><code class="language-html" data-lang="html">User-agent: EasterBot
Disallow: /
Allow: /hackyeaster/bots/bots.

User-agent: *
Disallow: /
</code></pre></div>


<p>Visiting the url <code>/hackyeaster/bots/bots.html</code> takes me to the CP30 Wiki page. That can&rsquo;t be right. So I decided
to spoof my user agent to be <code>EasterBot</code> and I get a different result. An image
with the following text</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">BAMA WABOKI PISAL FATATU FOMU WOSEBI SEJU SOWU SEJU - BAMAS MUFE WAFUB FOMU MOWEWE
</code></pre></div>


<p>Hrmm. I tried to decipher this many ways before I gave up and Googled it. It turns
out this is actually <a href="http://roila.org/language-guide/vocabulary/">ROILA</a> and
comes with a nice dictionary. So I set about translating it and got:</p>

<div class="highlight"><pre><code class="language-text" data-lang="text">you must make word of addition two and two - this be name of page
</code></pre></div>


<p>Right, so I add two and two to give four and I load up
<code>http://hackyeaster.hacking-lab.com//hackyeaster/bots/four.html</code> and see Gir with the
word <code>MetAE</code>. Well meta can only mean I need to look at the page metadata. Viewing the source
I see</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">content=</span><span class="s">&quot;Robots talk in ROILA language: eman egap eht esrever tsum&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;keywords&quot;</span> <span class="na">content=</span><span class="s">&quot;secret, page, robots, fun, hacky easter, blrt, five, beep&quot;</span><span class="nt">&gt;</span>
</code></pre></div>


<p>More ROILA? No, it&rsquo;s just backwards english. I&rsquo;ll just go to
<code>http://hackyeaster.hacking-lab.com//hackyeaster/bots/ruof.html</code> and get the egg/</p>

<h1 id="challenge-21:00aa8d5840836b6803fb0a2203b66750">Challenge 21</h1>

<p>I am told that <code>blue</code> is <code>110</code>. I took a guess that therefore red will be <code>011</code> and
green <code>101</code>. Basically the binary represents the RGB values inverted. Applying this
I wrote a script to translate the colours to a binary string and then conver that to ASCII
which gave me the egg&rsquo;s URL.</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/bin/env python</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;111&#39;</span><span class="p">,</span> <span class="s">&#39;110&#39;</span><span class="p">,</span> <span class="s">&#39;101&#39;</span><span class="p">,</span> <span class="s">&#39;100&#39;</span><span class="p">,</span> <span class="s">&#39;011&#39;</span><span class="p">,</span> <span class="s">&#39;010&#39;</span><span class="p">,</span> <span class="s">&#39;001&#39;</span><span class="p">,</span> <span class="s">&#39;000&#39;</span><span class="p">]</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;conycode.png&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span>
<span class="k">print</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">14.0</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">getdata</span><span class="p">())</span>
<span class="k">print</span> <span class="n">pixels</span><span class="p">[</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="k">print</span> <span class="n">pixels</span><span class="p">[</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="mi">18</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)]</span>
<span class="k">print</span>

<span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">18</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">18</span><span class="p">):</span>
        <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">codes</span><span class="p">[</span><span class="n">pixels</span><span class="p">[</span><span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">h</span><span class="p">)]])</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">bin_string</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_string</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_string</span><span class="p">),</span> <span class="mi">8</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bin_string</span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ba</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="n">t</span><span class="p">])</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ba</span><span class="p">))</span>
</code></pre></div>


<h1 id="challenge-22:00aa8d5840836b6803fb0a2203b66750">Challenge 22</h1>

<p>Hash cracking. I am new to this, but boy did I enjoy this challenge because I learned
a lot! I decided to use <a href="https://hashcat.net/oclhashcat/">hashcat</a> for all the hashes.</p>

<p>Let&rsquo;s begin:</p>

<h2 id="hash-1:00aa8d5840836b6803fb0a2203b66750">hash 1</h2>

<p>A 16 digit pin takes a long time to bruteforce, but the hint tells me that the only
numbers in the PIN are 1, 7, 9, and 0.</p>

<p><div class="highlight"><pre><code class="language-text" data-lang="text">hashcat -m100 -1 1790 --pw-min=16 --pw-max=16 -a3 hash1.txt ?1?1?1?1?1?1?1?1?1?1?1?1?1?1?1?1
</code></pre></div>
</p>

<p>time taken: 4:40 minutes</p>

<h2 id="hash-2:00aa8d5840836b6803fb0a2203b66750">hash 2</h2>

<p>This one had me stumped for ages, because it was hard to bruteforce and hashcat didn&rsquo;t support
sha384. Luckily I found <a href="https://crackstation.net/">Crackstation</a> where I entered the hash
and was immediately rewarded with the correct answer. Alternatively writing a brute forcer in Python
and using the Rockyou wordlist would also have worked.</p>

<h2 id="hash-3:00aa8d5840836b6803fb0a2203b66750">hash 3</h2>

<p>Here I employed hashcat&rsquo;s <a href="https://hashcat.net/wiki/doku.php?id=rule_based_attack">rule based attacks</a>
 to make myself a new wordlist based on the given rules.
First I needed to run the <code>toggle</code> rule to generate the words with one upper case char.
Then I ran a the substituion rule (which is the <code>leetspeak.rule</code>). Now I had a
list of words that had one substitution and one upper case letter. Only the
punctuation and digit missing now. For this step I wrote a python script
that would generate the required rule table:</p>

<p><div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">puncs</span> <span class="o">=</span> <span class="s">&#39;! @ # $ % ^ &amp; * ( ) _ + { } [ ] : ; . , / ? ~ `&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="n">nums</span> <span class="o">=</span> <span class="s">&#39;1 2 3 4 5 6 7 8 9 0&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;pn.rule&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">punc</span> <span class="ow">in</span> <span class="n">puncs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;$</span><span class="si">%s</span><span class="s">$</span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">punc</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;$</span><span class="si">%s</span><span class="s">$</span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">punc</span><span class="p">))</span>

<span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</p>

<p>I then used this rule to run it over the word list, then</p>

<pre><code>hashcat -m0 hash3.txt final.txt
</code></pre>

<p>to get the plaintext in 3 seconds.</p>

<h2 id="hash-4:00aa8d5840836b6803fb0a2203b66750">hash 4</h2>

<p>Here I needed to run hashcat&rsquo;s combinator attack a few times on the word list.
What this does is append each word of a wordlist to every other word.
Running this a few times will give me the list I need:</p>

<p><div class="highlight"><pre><code class="language-text" data-lang="text">hashcat -a1 wordlist.txt --stdout &gt; pass1.txt
hashcat -a1 -m1400 hash4.txt pass1.txt
</code></pre></div>
</p>

<p>Scoop the plaintext in 8 minutes.</p>

<h1 id="challenge-23:00aa8d5840836b6803fb0a2203b66750">Challenge 23</h1>

<p>Once connected to the server I have to insult the bot quickly and smartly. But who is
smarter than the bot? No one that&rsquo;s who. Except perhaps the bot itself. In essence
what needs to be done is get the taunts from the master and play them back
to him. Then use his replies as respsonses to his taunts.</p>

<p>I figure there&rsquo;s two ways of doing this;</p>

<pre><code>1. Connect the bot to itself via a client that relays the messages between the two
2. Record the quips and play them back automatically as needed
</code></pre>

<p>I plumped for option 2 and hoped there wouldn&rsquo;t be too many quips to harvest. Having
played against the bot a few times I managed to get myself the list of comebacks and
wrote a Python script to pwn the Nerd Master</p>

<p><div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">re</span>


<span class="n">challs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Pna lbh ernq guvf?&#39;</span><span class="p">:</span> <span class="s">&#39;EBG13 vf sbe ynzref.&#39;</span><span class="p">,</span>
          <span class="s">&quot;You&#39;re so slow, you must have been written in BASIC.&quot;</span><span class="p">:</span> <span class="s">&quot;At least I don&#39;t have memory leaks like you.&quot;</span><span class="p">,</span>
          <span class="s">&quot;Go 127.0.0.1 to your mummy.&quot;</span><span class="p">:</span> <span class="s">&quot;go 127.0.0.1 to your mom&quot;</span><span class="p">,</span>
          <span class="s">&quot;I have more friends than you.&quot;</span><span class="p">:</span> <span class="s">&quot;Yeah, but only until you update your Facebook profile with a real picture of you!&quot;</span><span class="p">,</span>
          <span class="s">&quot;You should leave your cave and socialize a bit.&quot;</span><span class="p">:</span> <span class="s">&quot;I&#39;m not anti-social. I&#39;m just not user friendly.&quot;</span><span class="p">,</span>
          <span class="s">&quot;This fight is like a hash function - it works in one direction only.&quot;</span><span class="p">:</span> <span class="s">&quot;Too bad you picked LM hashing.&quot;</span><span class="p">,</span>
          <span class="s">&quot;I bet you don&#39;t even understand binary.&quot;</span><span class="p">:</span> <span class="s">&quot;Sure I do. Me and you, we are 10 different kind of persons.&quot;</span><span class="p">,</span>
          <span class="s">&quot;1f u c4n r34d th1s u r s70p1d.&quot;</span><span class="p">:</span> <span class="s">&quot;You better check your spelling. Stoopid has two &#39;o&#39;s.&quot;</span><span class="p">,</span>
          <span class="s">&quot;After loosing to me, your life won&#39;t be the same anymore.&quot;</span><span class="p">:</span> <span class="s">&quot;A Life? Cool! Where can I download one of those?&quot;</span><span class="p">,</span>
          <span class="s">&quot;You&#39;ll be 0xdeadbeef soon.&quot;</span><span class="p">:</span> <span class="s">&quot;Not as long as I have my 0xcafebabe.&quot;</span><span class="p">,</span>
          <span class="s">&quot;Af7ter th1s f1gh7, I w1ll pwn ur b0x3n.&quot;</span><span class="p">:</span> <span class="s">&quot;Check your settings - you seem to have chosen the Klingon keyboard layout.&quot;</span><span class="p">,</span>
          <span class="s">&quot;I have more friends than you.&quot;</span><span class="p">:</span> <span class="s">&quot;Yeah, but only until you update your Facebook profile with a real picture of you!&quot;</span><span class="p">,</span>
          <span class="s">&quot;I&#39;ll check you out - any last words?&quot;</span><span class="p">:</span> <span class="s">&quot;svn:ignore&quot;</span><span class="p">,</span>
          <span class="s">&quot;Tell me your name, hobo. I need to check your records.&quot;</span><span class="p">:</span> <span class="s">&quot;My name is bob&#39;; DROP TABLE VALJ;--&quot;</span><span class="p">,</span>
          <span class="s">&quot;format C:&quot;</span><span class="p">:</span> <span class="s">&quot;Specified drive does not exist.&quot;</span><span class="p">,</span>
          <span class="s">&quot;You must be jealous when seeing my phone&#39;s display.&quot;</span><span class="p">:</span> <span class="s">&quot;Not really - Your pixels are so big, some of them have their own region code!&quot;</span><span class="p">,</span>
          <span class="s">&quot;Ping! Anybody there?&quot;</span><span class="p">:</span> <span class="s">&quot;ICMP type 3, code 13: Communication Administratively Prohibited&quot;</span>
          <span class="p">}</span>

<span class="n">tosends</span> <span class="o">=</span> <span class="n">challs</span>

<span class="k">def</span> <span class="nf">removekey</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">r</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">r</span>

<span class="k">def</span> <span class="nf">sendchall</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">chall</span><span class="p">):</span>
    <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">challs</span><span class="p">[</span><span class="n">chall</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">netcat</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">tosends</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">print</span> <span class="s">&quot;Received:&quot;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">data</span> <span class="o">==</span> <span class="s">&quot;Speechless?</span><span class="se">\n</span><span class="s">&quot;</span> <span class="ow">or</span>
            <span class="n">data</span> <span class="o">==</span> <span class="s">&#39;Go play with your toys, yellow-belly.</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">):</span>
            <span class="k">print</span> <span class="n">data</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">data</span> <span class="o">==</span> <span class="s">&#39;Do you feel brave enough to challenge the mighty nerdmaster? (y|n)</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="s">&#39;y</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&quot;.*YOUR TURN ----</span><span class="se">\\</span><span class="s">n&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">chal</span> <span class="o">=</span> <span class="n">tosends</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tosends</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">chal</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&#39;send challenge: &#39;</span><span class="p">,</span> <span class="n">chal</span>
            <span class="n">tosends</span> <span class="o">=</span> <span class="n">removekey</span><span class="p">(</span><span class="n">tosends</span><span class="p">,</span> <span class="n">chal</span><span class="p">)</span>
            <span class="k">continue</span>



        <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">&#39;.*MY TURN ----</span><span class="se">\\</span><span class="s">n(.*)</span><span class="se">\\</span><span class="s">n&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">chal</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">chal</span> <span class="ow">in</span> <span class="n">challs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">sendchall</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">chal</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">challs</span><span class="p">[</span><span class="n">chal</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
                <span class="k">continue</span>
            <span class="k">continue</span>

        <span class="k">print</span> <span class="s">&#39;::::::&#39;</span><span class="p">,</span> <span class="n">data</span>


    <span class="k">print</span> <span class="s">&quot;Connection closed.&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">nc</span> <span class="o">=</span> <span class="n">netcat</span><span class="p">(</span><span class="s">&#39;hackyeaster.hacking-lab.com&#39;</span><span class="p">,</span> <span class="mi">1400</span><span class="p">)</span>
</code></pre></div>
</p>

<h1 id="challenge-24:00aa8d5840836b6803fb0a2203b66750">Challenge 24</h1>

<p>Hrm, this really isn&rsquo;t a secure hash at all. A Python script can do this</p>

<p><div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">Crypto.Hash</span> <span class="kn">import</span> <span class="n">MD2</span><span class="p">,</span> <span class="n">MD5</span><span class="p">,</span> <span class="n">SHA</span><span class="p">,</span> <span class="n">SHA256</span><span class="p">,</span> <span class="n">SHA512</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">part_1</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">MD2</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
        <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">hashed</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">hashed</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&#39;[*] First part is:&#39;</span><span class="p">,</span> <span class="n">word</span>
            <span class="k">return</span>

<span class="k">def</span> <span class="nf">part_2</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">MD5</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
        <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">hashed</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">hashed</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&#39;[*] Second part is:&#39;</span><span class="p">,</span> <span class="n">word</span>
            <span class="k">return</span>

<span class="k">def</span> <span class="nf">part_3</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">SHA</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
        <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">hashed</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">hashed</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&#39;[*] Third part is:&#39;</span><span class="p">,</span> <span class="n">word</span>
            <span class="k">return</span>

<span class="k">def</span> <span class="nf">part_4</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">SHA256</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
        <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">hashed</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">hashed</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&#39;[*] Fourth part is:&#39;</span><span class="p">,</span> <span class="n">word</span>
            <span class="k">return</span>

<span class="k">def</span> <span class="nf">part_5</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">SHA512</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
        <span class="n">h</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
        <span class="n">hashed</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">hashed</span><span class="p">[</span><span class="mi">24</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
            <span class="k">print</span> <span class="s">&#39;[*] Fifth part is:&#39;</span><span class="p">,</span> <span class="n">word</span>
            <span class="k">return</span>


<span class="n">my_chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span>

<span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;757c47&#39;</span><span class="p">,</span><span class="s">&#39;9895d6&#39;</span><span class="p">,</span> <span class="s">&#39;845b2b&#39;</span><span class="p">,</span> <span class="s">&#39;0530cd&#39;</span><span class="p">,</span> <span class="s">&#39;9a2b11&#39;</span><span class="p">]</span>

<span class="n">which_part</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">gen</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations_with_replacement</span><span class="p">(</span><span class="n">my_chars</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">print</span> <span class="s">&#39;[+] Here we go....&#39;</span><span class="p">,</span> <span class="n">which_part</span>

<span class="k">if</span> <span class="n">which_part</span> <span class="o">==</span> <span class="s">&#39;1&#39;</span><span class="p">:</span>
    <span class="n">part_1</span><span class="p">()</span>

<span class="k">if</span> <span class="n">which_part</span> <span class="o">==</span> <span class="s">&#39;2&#39;</span><span class="p">:</span>
    <span class="n">part_2</span><span class="p">()</span>

<span class="k">if</span> <span class="n">which_part</span> <span class="o">==</span> <span class="s">&#39;3&#39;</span><span class="p">:</span>
    <span class="n">part_3</span><span class="p">()</span>

<span class="k">if</span> <span class="n">which_part</span> <span class="o">==</span> <span class="s">&#39;4&#39;</span><span class="p">:</span>
    <span class="n">part_4</span><span class="p">()</span>

<span class="k">if</span> <span class="n">which_part</span> <span class="o">==</span> <span class="s">&#39;5&#39;</span><span class="p">:</span>
    <span class="n">part_5</span><span class="p">()</span>

<span class="k">print</span> <span class="s">&#39;[+] Finished&#39;</span>
</code></pre></div>
</p>

<h1 id="challenge-25:00aa8d5840836b6803fb0a2203b66750">Challenge 25</h1>

<p>Not solved.</p>

<h1 id="challenge-26:00aa8d5840836b6803fb0a2203b66750">Challenge 26</h1>

<p>I saw no really easy way to do this other than taking apart the apk and
using <code>dex2jar</code> on the main java file. In this file I found the code
that makes use of the PIN and reversed engineered the code. There&rsquo;s
some hashing and ultimately the app will download the egg.</p>

<p>So I reimplemented the Java code and bruteforced it. A few numbers matched,
so I just entered them until I got a valid download:
(disclaimer: I am not very good at Java at all)</p>

<p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.MessageDigest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.SecureRandom</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.Matcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.regex.Pattern</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.*</span><span class="o">;</span> <span class="c1">//MessageDigest;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.Graphics</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.awt.image.BufferedImage</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.ByteArrayInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.*</span><span class="o">;</span> <span class="c1">//MessageDigest;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.imageio.ImageIO</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JFrame</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JPanel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">sun.misc.BASE64Decoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">sun.misc.BASE64Encoder</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorld</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">do_sha</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">,</span> <span class="n">String</span> <span class="n">s1</span><span class="o">,</span> <span class="kt">int</span> <span class="n">i1</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">NoSuchAlgorithmException</span>
    <span class="o">{</span>
        <span class="n">MessageDigest</span> <span class="n">messagedigest</span> <span class="o">=</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&quot;SHA1&quot;</span><span class="o">);</span>
        <span class="kt">byte</span> <span class="n">abyte0</span><span class="o">[]</span> <span class="o">=</span> <span class="o">(</span><span class="k">new</span> <span class="n">StringBuilder</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">s1</span><span class="o">))).</span><span class="na">append</span><span class="o">(</span><span class="n">s</span><span class="o">).</span><span class="na">toString</span><span class="o">().</span><span class="na">getBytes</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">j1</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">do</span>
        <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">j1</span> <span class="o">&gt;=</span> <span class="n">i1</span><span class="o">)</span>
            <span class="o">{</span>
                <span class="kt">byte</span> <span class="n">abyte1</span><span class="o">[]</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
                <span class="n">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">abyte0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">abyte1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">15</span><span class="o">);</span>
                <span class="k">return</span> <span class="n">abyte1</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">abyte0</span> <span class="o">=</span> <span class="n">messagedigest</span><span class="o">.</span><span class="na">digest</span><span class="o">(</span><span class="n">abyte0</span><span class="o">);</span>
            <span class="n">j1</span><span class="o">++;</span>
        <span class="o">}</span> <span class="k">while</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">hardwork</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">String</span> <span class="n">s1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">();</span>
        <span class="k">try</span>
        <span class="o">{</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&quot;AES&quot;</span><span class="o">);</span>
            <span class="n">SecretKeySpec</span> <span class="n">secretkeyspec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">do_sha</span><span class="o">(</span><span class="n">s</span><span class="o">,</span> <span class="s">&quot;ovaederecumsale&quot;</span><span class="o">,</span> <span class="mi">10000</span><span class="o">),</span> <span class="s">&quot;AES&quot;</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">secretkeyspec</span><span class="o">);</span>
            <span class="n">BASE64Decoder</span> <span class="n">decoder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BASE64Decoder</span><span class="o">();</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">decodedBytes</span> <span class="o">=</span> <span class="n">decoder</span><span class="o">.</span><span class="na">decodeBuffer</span><span class="o">(</span><span class="s">&quot;8QeNdEdkspV6+1I77SEEEF4aWs5dl/auahJ46MMufkg=&quot;</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">plaintxt</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">decodedBytes</span><span class="o">);</span>
            <span class="n">BASE64Encoder</span> <span class="n">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BASE64Encoder</span><span class="o">();</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="na">encodeBuffer</span><span class="o">(</span><span class="n">plaintxt</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">exception</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s1</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">s1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span>  <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="o">{</span>
        <span class="n">hardwork</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
</p>

<h1 id="challenge-27:00aa8d5840836b6803fb0a2203b66750">Challenge 27</h1>

<p>One time pad with a reused pad. Another challenge that taught me a lot, specifically
cribdragging. Having found <a href="https://github.com/SpiderLabs/cribdrag">this tool</a> I started
to figure out how to use this.</p>

<p>Basically you need to take two of the encrypted texts, use the <code>xorstrings</code> to
xor them together and then pass that to the <code>cribdrag</code> tool. Then you need to start
entering words that might be in the text. If a word like <code>the</code>, or <code>and</code>, are in the
text, you should see some plaintext appear in the output. Then perhaps pad the word
with spaces either side. Once you have more of the plaintext, you can use that to
expand the strings in either text.</p>

<p>Eventually you will get the plain text for either string. Using that you can then
decipher the other texts.</p>

<p>The strings increase in length, so combine them all until you have the final
sentence.</p>

<p>Here&rsquo;s a quick example for a couple of the lines:</p>

<p><a href="https://asciinema.org/a/65rhh2rqofe51f0yst1nktmbu"><img src="https://asciinema.org/a/65rhh2rqofe51f0yst1nktmbu.png" alt="asciicast" /></a></p>

      </article>

      <p class="post-meta">Tags:&nbsp;
        
            
            <a href="http://unlogic.co.uk//tags/hacky%20easter">hacky easter</a>
        
            ,&nbsp;
            <a href="http://unlogic.co.uk//tags/ctf">ctf</a>
        
            ,&nbsp;
            <a href="http://unlogic.co.uk//tags/white%20hat">white hat</a>
        
      </p>

      
<div id="disqus_thread">
  <script type="text/javascript">
     var disqus_shortname = "unlogic";
     var disqus_identifier = "\/2015\/06\/01\/hacky-easter-2015\/";

     (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
</div>


    </div>
  </div>
</div>
    <footer class="footer">
      <div class="p2 wrap">
        <div class="measure mt1 center">
      <nav class="social-icons icons">
<a class="fa fa-rss rss" href="http://unlogic.co.uk/index.xml"></a>

<a class="fa fa-twitter twitter" href="https://twitter.com/binaryheadache"></a>

</nav>

          <small>
            Copyright &#169; 2015<br>
            Powered by <a href="http://gohugo.io/" target="_blank">Hugo</a> &amp; <a href="https://github.com/azmelanar/hugo-theme-pixyll" target="_blank">Pixyll</a>
          </small>
        </div>
      </div>
    </footer>

    
    <script src="http://unlogic.co.uk/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    


</body>
</html>

